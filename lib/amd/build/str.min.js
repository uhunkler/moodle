define(["jquery","core/ajax"],function(a,b){return{get_string:function(b,c,d,e){var f=a.Deferred(),g=this.get_strings([{key:b,component:c,param:d,lang:e}]);return g.done(function(a){f.resolve(a[0])}).fail(function(a){f.reject(a)}),f.promise()},get_strings:function(c){var d,e=a.Deferred(),f=[],g=0,h=!1;for(g=0;g<c.length;g++)d=c[g],("undefined"==typeof M.str[d.component]||"undefined"==typeof M.str[d.component][d.key])&&(h=!0);if(h){var i=[];for(g=0;g<c.length;g++)d=c[g],"undefined"==typeof d.lang&&(d.lang=a("html").attr("lang")),i.push({methodname:"core_get_string",args:{stringid:d.key,component:d.component,lang:d.lang,stringparams:[]}});var j=b.call(i);a.when.apply(null,j).done(function(){var a=0;for(a=0;a<arguments.length;a++)d=c[a],"undefined"==typeof M.str[d.component]&&(M.str[d.component]=[]),M.str[d.component][d.key]=arguments[a],f[a]=M.util.get_string(d.key,d.component,d.param).trim();e.resolve(f)}).fail(function(a){e.reject(a)})}else{for(g=0;g<c.length;g++)d=c[g],f[g]=M.util.get_string(d.key,d.component,d.param);e.resolve(f)}return e.promise()}}});